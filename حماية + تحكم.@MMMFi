
#This bot is developed by Hamoudi AL-Amir 𓅂
#Developer Channel | @MMMFi ✓.

from kvsqlite.sync import Client
import telebot
import time
import os
from gtts import gTTS
import random
from telebot.types import ChatMember
from telebot import types
from telebot.types import InlineKeyboardButton as but , InlineKeyboardMarkup as key

token = "6185018837:AAGAzeTKql0w6IEB9qPEjpXTaFD4JaO9qjg"   #توكنك
bot = telebot.TeleBot(token)

db = Client('Sq.sqlite')
onwer = int('2041495193') #ID
if not db.get('db'):
    data = {'onwer':[],'admin': [], 'users': [] , 'band':[], 'status': 1}
    db.set('db',data)
if not onwer in db.get('db')['onwer']:
    data = db.get('db')
    data['onwer'].append(onwer)
    db.set('db',data)
@bot.message_handler(commands = ['mmmfi'])
def staty(m):
 status = db.get("status")
 channel = db.get("channel")
 userg = len(db.get('db')['users'])
 for i in db.get('db')['onwer']:
     pass
 print(channel)
 data = db.get('db')
 user_id = m.from_user.id
 if user_id in data['band']:
     bot.send_message(m.chat.id,'تم حظرك من البوت 🚫')
 if data['status'] == 2:
     pass
 else:
     if not user_id in data['users']:
         data = db.get('db')
         data['users'].append(user_id)
         db.set('db',data)
         sug = len(db.get("db")["users"])
         text = f' مرحبا بك في البوت\n\nID : {user_id}\nNAME : {m.from_user.first_name}\nUSER : {m.from_user.username}\n\nعدد الاعضاء :{sug}'
         if len(db.get("db")['admin']) > 0:
             for x in data['admin']:
                 print(x)
                 bot.send_message(int(x),text)
             bot.send_message(int(i),text)
         bot.send_message(int(i),text)
 if not db.get('channel'):
     if user_id in data['onwer'] or user_id in data['admin']:
         bot.send_message(m.chat.id,'''This bot is developed by Hamoudi AL-Amir 𓅂
Developer Channel | @MMMFi ✓.''')
 else:
     if not db.get('status'):
         pass
     if db.get('status'):
         member = bot.get_chat_member(f"@{channel}",m.from_user.id)
         if member.status == "member" or member.status == "administartor" or member.status == "creator":
             pass
         else:
             bot.send_message(m.chat.id,f'- يرجى الاشتراك في قناة البوت لـ تتمكن من استخدامة ⚠️	                                                    - قناة البوت | https://t.me/{channel} ✅         • اشترك ثم اضغط /start 🔥')
 v= key()	
 add_adm = but('اضافة ادمن 🕹️',callback_data = 'add')	
 delete_adm = but('تنزيل ادمن 🕹️', callback_data = 'delet')
 rem = but('احصائيات 📊',callback_data = 'statc')
 ban = but('حظر عضو 🚫',callback_data = 'banme')
 bun = but('الغاء حظر عضو 🚫',callback_data = 'baning')
 brod = but('اذاعة 📣',callback_data = 'brod')
 ba = but(f'وضع قناة الاشتراك 🌐',callback_data = 'geti')
 bn =but('فتح الاشتراك الاجباري ✅',callback_data = 'ope')
 tnb = but('فتح التنبيه ✅',callback_data = 'tnb')
 clo = but('تعطيل التنبيه ❌',callback_data = 'clo')
 jio = but('حالة الاشتراك الاجباري 🚸',callback_data = 'ses')
 best = but('تعطيل الاشتراك الاجباري ❌',callback_data = 'gohn')
 dest = but(f'حذف قناة الاشتراك 🗑️',callback_data = 'gets')
 est = but(f'قناة الاشتراك❗',callback_data = 'gs')
 kop = but("حاله التنبيه ⚙️",callback_data = "kop")
 v.add(add_adm,delete_adm)
 v.add(brod)
 v.add(ba,dest)
 v.add(est)
 v.add(tnb,clo)
 v.add(jio)
 v.add(bn,best)
 v.add(rem)
 v.add(bun,ban)
 v.add(kop)
 h = key()
 rem = but('احصائيات 📊',callback_data = 'statc')
 brod = but('اذاعة 📣',callback_data = 'brod')
 h.add(ba,dest)
 h.add(est)
 h.add(tnb,clo)
 h.add(jio)
 h.add(bn,best)
 h.add(rem,brod)
 h.add(kop)
 if user_id in data['onwer'] :
     bot.send_message(m.chat.id,'- مرحبا بك عزيزي المالك يمكنك التحكم في البوت من خلال الأزرار ادناة 👇 							                            • تم تطوير هذة اللوحة من قبل قناة صانع بوتات الأمير | @MMMFi ✅',reply_markup = v)
 if user_id in data['band']:
     pass
 else:
     if user_id in data['admin']:
         bot.send_message(m.chat.id,'- مرحبا بك عزيزي الادمن يمكنك التحكم في البوت من خلال الأزرار ادناة 👇 							                            • تم تطوير هذة اللوحة من قبل قناة صانع بوتات الأمير | @MMMFi ✅',reply_markup = h)
@bot.callback_query_handler(func=lambda c: True)
def handle_callback(c):
    channel = db.get("channel")
    user_id = c.from_user.id
    data = db.get('db')
    use = len(db.get('db')['users'])
    adm = len(db.get('db')['admin'])
    bans = len(db.get('db')['band'])
    dg = f'''
band  : {bans} 🚫
member : {use} 👥
admin : {adm} 🛃
          '''
    if c.data == 'add': 
        if user_id in data['onwer']:
            m = bot.send_message(c.message.chat.id,'ارسل ايدي الشخص لـرفعة ادمن ✅')
            bot.register_next_step_handler(m,adds)
    if c.data == 'delet': 
        if user_id in data['onwer']:
            ha = bot.send_message(c.message.chat.id,'ارسل ايدي الشخص الذي تريد تنزيلة من الادمنية ✅')
            bot.register_next_step_handler(ha,dgh)
    if c.data == 'banme': 
        if user_id in data['onwer']:
            lita = bot.send_message(c.message.chat.id,'✅ ارسل ايدي الشخص الذي تريد حظره' )
            bot.register_next_step_handler(lita,hhg)
    if c.data == 'baning' : 
        if user_id in data['onwer']:
            li = bot.send_message(c.message.chat.id,'✅ ارسل ايدي الشخص الذي تريد فك الحظر عنه ')
            bot.register_next_step_handler(li,hgf)
    if c.data == 'statc' : 
        if user_id in data['onwer'] or user_id in data['admin']:
            bot.send_message(c.message.chat.id,dg)
    if c.data == 'brod':
        if user_id in data['onwer'] or user_id in data['admin']:
            xc = bot.send_message(c.message.chat.id,'- ارسل النص الذي تريد ارسالة ( نص ، صوره ، ملف ) 💯')
            bot.register_next_step_handler(xc,cx)
    if c.data == 'geti':
        if user_id in data['onwer'] or user_id in data['admin']:
            fiul = bot.send_message(c.message.chat.id,'ارسل يوزر القناة بدون @')
            bot.register_next_step_handler(fiul,setz)
    if c.data == 'gs':
        if user_id in data['onwer'] or user_id in data['admin']:
            if not db.get('channel'):
                bot.send_message(c.message.chat.id,'لم يتم تحديد قناة❗')
            else:
                channel = db.get('channel')
                bot.send_message(c.message.chat.id,f'https://t.me/{channel}')
    if c.data == 'gets':
        if user_id in data['onwer'] or user_id in data['admin']:
            if db.get('channel'):
                db.delete('channel')
                bot.send_message(c.message.chat.id,'تم حذف القناة 🗑️')
            else:
                bot.send_message(c.message.chat.id,'لا توجد قناة مضافه ❌')
    if c.data == 'ope':
        if user_id in data['onwer'] or user_id in data['admin']:
            if not db.get('status'):
                db.set('status',1)
                bot.send_message(c.message.chat.id,'تم تفعيل الاشتراك الاجباري ✅')
            else:
                bot.send_message(c.message.chat.id,'الاشتراك مغعل من قبل❗')
    if c.data == "gohn":
        if user_id in data['onwer'] or user_id in data['admin']:
            if db.get('status'):
                db.delete('status')
                bot.send_message(c.message.chat.id,'تم تعطيل الاشتراك ✅')
            else:
                bot.send_message(c.message.chat.id,'الاشتراك معطل من قبل❗')
    if c.data == "ses":
        if user_id in data['onwer'] or user_id in data['admin']:
            if db.get('status'):
                bot.answer_callback_query(c.id,"الاشتراك الاجباري مفعل ✅",show_alert=True)
            elif not db.get("status"):
                bot.answer_callback_query(c.id,"الاشتراك الاجباري معطل ❌",show_alert=True)
    if c.data == "tnb":
        if user_id in data['onwer'] or user_id in data['admin']:
            if db.get('db')['status'] == 1:
                bot.send_message(c.message.chat.id,"التنبيه مفتوح من قبل❗")
            else:
                data["status"] = 1
                db.set("db",data)
                bot.send_message(c.message.chat.id,"تم فتح التنبيه ✅")
    if c.data == "clo":
        if user_id in data['onwer'] or user_id in data['admin']:
            if data["status"] == 2:
                bot.send_message(c.message.chat.id,"التنبيه معطل من قبل❗")
            else:
                data["status"] = 2
                db.set("db",data)
                bot.send_message(c.message.chat.id,"تم تعطيل التنبيه ✅")
    if c.data == "kop":
        if user_id in data['onwer'] or user_id in data['admin']:
            if data["status"] == 2 :
                bot.answer_callback_query(c.id,"التنبيه معطل ❌",show_alert=True)
            else:
                bot.answer_callback_query(c.id,"التنبيه مفتوح ✅",show_alert=True)
def setz(message):
    chn = message.text
    if not db.get('channel'):
        db.delete('channel')
        db.set('channel',chn)
        bot.send_message(message.chat.id,'تم تحديد القناة ✅                                                      • تأكد من أن البوت ادمن في القناة لكي يعمل بشكل صحيح ⚠️                                              Developer Channel | @MMMFi ✓.')
    else:
        bot.send_message(message.chat.id,"❗ يوجد قناة اخري يرجى حذفها لوضع قناة ثانيه")
def cx(message):
    ko = db.get('db')['users']
    for i in ko:
        bot.copy_message(chat_id=i, from_chat_id=message.chat.id, message_id=message.message_id)
def hgf(message):
    data = db.get('db')
    idg = int(message.text)
    if idg in data['band']:
        data['band'].remove(int(f'{idg}'))
        db.set('db',data)
        bot.send_message(message.chat.id,'تم فك الحظر ✅')
    else:
        bot.send_message(message.chat.id,'لم يتم حظر هذا الشخص ❌')
def hhg(message):
    data = db.get('db')
    ids = int(message.text)
    if not ids in data['band']:
        data['band'].append(int(f'{ids}'))
        db.set('db',data)
        bot.send_message(message.chat.id,'تم حظره 🚫')
    else:
        bot.send_message(message.chat.id,'لا يوجد شخص بهذا الايدي❗')
def dgh(message):
    data = db.get('db')
    idd = int(message.text)
    if idd in data['admin']:
        data['admin'].remove(idd)
        db.set('db',data)
        bot.send_message(message.chat.id,'تم تنزيل من الادمن ✅')
    else:
        bot.send_message(message.chat.id,'ليس مرفوع في قائمه الادمنية❗')
def adds(message):
    data = db.get('db')
    id = int(message.text)
    if id in data['admin']:
        bot.send_message(message.chat.id,'مرفوع من قبل❗')
    else:
        data['admin'].append(int(f'{id}'))
        db.set('db',data)
        print(data)
        bot.send_message(message.chat.id,'تم رفع ادمن ✅')
        

btn = types.InlineKeyboardButton(text='صانع بوتات الامير 𓅂', url = "http://t.me/MOQ_Bot?start")
@bot.message_handler(commands=["start"])
def start(message):
	brok = types.InlineKeyboardMarkup()
	brok.add(btn)
	bot.reply_to(message,text='''⌯︙أهلآ بك عزيزي 🙋‍♂
⌯︙اختصاص البوت حماية المجموعات 🔥
⌯︙لتفعيل البوت عليك اتباع مايلي 👇...
⌯︙اضف البوت الى مجموعتك 
⌯︙ارفعه ادمن {مشرف} 
⌯︙ارسل كلمة { تفعيل } ليتم تشغيل البوت في مجموعتك ''',reply_markup=brok)

admin_id = "2041495193"   #ايديك
userk = [2041495193]   #ايديك

@bot.message_handler(func=lambda message: message.text == "الاوامر")
def lock_images(message):

    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if member.status in ['administrator', 'creator']:
        
        if chat_id not in locked_groups:
            locked_groups.append(chat_id)
        bot.reply_to(message, """⌁︙اهلا عزيزي الادمن 🧜🏻 .
⌁︙ اوامر الحماية ارسل ↫`M1`
⌁︙اوامر الالعاب ارسل ↫`M2`
⌁︙اوامر التسلية ارسل ↫`M3`
⌁︙اوامر اخرى ارسل ↫`M4`
⌁︙اوامر الردود ارسل ↫`M5`
⌁︙اضغط على الامر لـ النسخ 👾""",parse_mode="markdown")
    else:
        bot.reply_to(message, "⌁︙انت مو ادمن ياعضو 💃🏻 !")
                   
@bot.message_handler(func=lambda message: message.text == "تفعيل" )
def lock_images(message):

    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if member.status in ['administrator', 'creator']:
        
        if chat_id not in locked_groups:
            locked_groups.append(chat_id)
        bot.reply_to(message, """*- تـم تفعيل البوت بنجاح ✅

• ارسل (*`الاوامر`*) لمعرفة اوامر البوت 💯*""",parse_mode="markdown")
    else:
        bot.reply_to(message, "⌁︙انت مو ادمن ياعضو 💃🏻 !")
        
        
@bot.message_handler(func=lambda message: message.text == "M1")
def lock_images(message):

    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if member.status in ['administrator', 'creator']:
        
        if chat_id not in locked_groups:
            locked_groups.append(chat_id)
        bot.reply_to(message, """*⌁︙اهلا عزيزي الادمن باوامر الحماية 🛡️ .*
        
⌁︙`حظر` | (بالرد )* يحظر العضو *
⌁︙`الغاء الحظر` | (بالرد ) *يلغي حظر العضو*
⌁︙`تقييد` | ( بالرد ) *يقييد العضو من الكتابة*
⌁︙`الغاء التقييد` | ( بالرد ) *يلغي تقييد العضو*
⌁︙`تقييد وقتي` | ( بالرد ) *يقييد العضو لمدة 10 دقائق*
⌁︙`تحذير` | ( بالرد ) * إذا تم تحذير الشخص ثلاث مرات يتم تقييده*
⌁︙`قفل الصور` | *يبدأ البوت بمسح الصور التي يرسلها الاعضاء*
⌁︙`فتح الصور` | *يتوقف البوت عن مسح الصور التي يرسلها الاعضاء*
⌁︙`قفل الملصقات` | *يبدأ البوت بمسح الملصقات التي يرسلها الاعضاء*
⌁︙`فتح الملصقات` | *يتوقف البوت عن مسح الملصقات التي يرسلها الاعضاء*

*⌁︙ يستطيع التحكم في هذه الأوامر المشرفين والأمنية في المجموعة ✅*
⌁︙اضغط على اي امر لنسخه 👾 .""",parse_mode="markdown")
    else:
        bot.reply_to(message, "⌁︙انت مو ادمن ياعضو 💃🏻 !")        
        
@bot.message_handler(func=lambda msg: msg.text is not None and "M2" in msg.text)
def reply_hello(message):
    bot.reply_to(message, """*⌁︙اهلا عزيزي باوامر الالعاب 🎮🕹️ .*
⌁︙`نرد` ↫يرسلك رقم من 1 الى 6 اذا طلع 6 انت فايز بس اذا طلع 5 او 4 او 3 او 2 او 1 تخسر 😔 .
⌁︙`سلة` ↫يرسل لك لعبة كرة السلة .
⌁︙`كرة` ↫يرسل لك لعبة كرة القدم .
⌁︙`الاسرع` ↫يرسل لك كلمة واسرع احد يكتبها يفوز .
- اضغط على اسم اللعبة للنسخ 👾 .""",parse_mode="markdown")

@bot.message_handler(func=lambda msg: msg.text is not None and "الالعاب" in msg.text)
def reply_hello(message):
    bot.reply_to(message, """*⌁︙اهلا عزيزي  باوامر الالعاب 🎮🕹️ .*
⌁︙`نرد` ↫يرسلك رقم من 1 الى 6 اذا طلع 6 انت فايز بس اذا طلع 5 او 4 او 3 او 2 او 1 تخسر 😔 .
⌁︙`سلة` ↫يرسل لك لعبة كرة السلة .
⌁︙`كرة` ↫يرسل لك لعبة كرة القدم .
⌁︙`الاسرع` ↫يرسل لك كلمة واسرع شخص يكتبها يفوز .
- اضغط على اسم اللعبة للنسخ 👾 .**""",parse_mode="markdown")
        
@bot.message_handler(func=lambda msg: msg.text is not None and "M3" in msg.text)
def reply_hello(message):
    bot.reply_to(message, """*⌁︙اهلا عزيزي باوامر التسلية 💃🏻 .*
⌁︙رد على الشخص من اجل استعمال الامر
⌁︙`رفع حلو`
⌁︙`ذكائي`
⌁︙`غبائي`
⌁︙`تحبني`
*⌁︙اضغط على اي وحدة لنسخها 👾 .
⌁︙الاوامر يقدر يستخدمها العضو عادي 💃🏻 .*
⌁︙قريباً اوامر اكثر 😉 .""",parse_mode="markdown")                



@bot.message_handler(func=lambda msg: msg.text is not None and "M4" in msg.text)
def reply_hello(message):
    bot.reply_to(message, """*⌁︙اهلا عزيزي باوامر أخرى 🪗 .*
⌁︙`ايدي`
⌁︙`ايدي المجموعة`
⌁︙`الرابط`
⌁︙`المالك`
⌁︙`سورس`
⌁︙`السورس`
⌁︙`تفاعلي`
⌁︙`شعر`
⌁︙`سوره`
*⌁︙اوامر النطق 🔊... *
⌁︙`انطق` + الرسالة 
*⌁︙مثال* ( انطق مرحبا )
*⌁︙اضغط على اي وحدة لنسخها 👾 .*""",parse_mode="markdown")                              

@bot.message_handler(func=lambda message: message.text == "M5" )
def lock_images(message):

    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if member.status in ['administrator', 'creator']:
        
        if chat_id not in locked_groups:
            locked_groups.append(chat_id)
        bot.reply_to(message, """*⌁︙اهلا عزيزي الادمن باوامر الردود 📨 .*

- `اضف رد` | *لـ إضافة رد جديد إلى البوت*
- `حذف رد` | *لـ حذف رد معين تم إضافته سابقاً*
- `حذف الردود` | *لـ حذف جميع الردود المضافة*
- `قائمة الردود` | *لـ معرفة جميع الردود التي تم إضافتها* 

*⌁︙ يستطيع التحكم في هذه الأوامر المشرفين والأمنية في المجموعة ✅*
⌁︙اضغط على اي امر لنسخه 👾 .""",parse_mode="markdown")
    else:
        bot.reply_to(message, "⌁︙انت مو ادمن ياعضو 💃🏻 !")     
              
@bot.message_handler(func=lambda message: message.text == 'المالك')
def get_group_owner(message):
    if message.chat.type == 'supergroup' or message.chat.type == 'group':
        chat_id = message.chat.id
        chat_admins = bot.get_chat_administrators(chat_id)

        for admin in chat_admins:
            if admin.status == 'creator':
                owner_id = admin.user.id
                owner_username = admin.user.username
                owner_name = admin.user.first_name

                if hasattr(admin.user, 'photo'):
                    owner_photo_id = admin.user.photo.big_file_id
                    bot.send_photo(message.chat.id, owner_photo_id)

                reply = f'''- 𝐆𝐑𝐎𝗨𝐏 𝐎𝐖𝐍𝐄𝐑 ✅ |

• 𝗨𝐒𝐄𝐑𝐍𝐀𝐌𝐄 :- @{owner_username} 
• 𝐍𝐀𝐌𝐄 :- {owner_name}
• 𝐈𝐃 :- {owner_id}'''
                bot.reply_to(message, reply)
                return
        bot.reply_to(message, 'لا يمكن العثور على معلومات المالك في هذه المجموعة.')

    else:
        bot.reply_to(message, 'هذا الأمر يمكن استخدامه فقط في المجموعات.')

@bot.message_handler(func=lambda message: message.text.startswith('حظر') and message.reply_to_message is not None)
def ban(message):
    if str(message.from_user.id) != admin_id:
        bot.send_message(message.chat.id, "أنت مو مشرف")
    else:
        cid = message.chat.id
        uid = message.reply_to_message.from_user.id
        bot.kick_chat_member(cid, uid)
        bot.send_message(cid, "تم حظر العضو بنجاح")

@bot.message_handler(func=lambda message: message.text.startswith('الغاء الحظر') and message.reply_to_message is not None)
def unban(message):
    if str(message.from_user.id) != admin_id:
        bot.send_message(message.chat.id, "أنت مو مشرف")
    else:
        cid = message.chat.id
        uid = message.reply_to_message.from_user.id
        bot.unban_chat_member(cid, uid)
        bot.send_message(cid, "تم إلغاء حظر العضو بنجاح")                           
muted_users = {}

@bot.message_handler(func=lambda message: message.text == 'تقييد')
def handle_mute(message):
    chat_id = message.chat.id
    user_id = message.reply_to_message.from_user.id
    bot.restrict_chat_member(chat_id, user_id, can_send_messages=False)
    bot.reply_to(message.reply_to_message, "*- تم تقييدك في المجموعة 📛 .*",parse_mode="Markdown")

@bot.message_handler(func=lambda message: message.text == 'الغاء التقييد')
def handle_unmute(message):
    chat_id = message.chat.id
    user_id = message.reply_to_message.from_user.id
    bot.restrict_chat_member(chat_id, user_id, can_send_messages=True)
    bot.reply_to(message.reply_to_message, "*- تم إلغاء تقييدك بنجاح ✅ .*",parse_mode="Markdown")

@bot.message_handler(func=lambda message: message.reply_to_message and message.reply_to_message.from_user.id == bot.get_me().id)
def handle_user_messages(message):
    chat_id = message.chat.id
    user_id = message.from_user.id
    if user_id in muted_users and muted_users[user_id] == chat_id:
        try:
            bot.delete_message(chat_id, message.message_id)
        except telebot.apihelper.ApiTelegramException as e:
            if "message to delete not found" in str(e):
                bot.send_message(chat_id, "الرسالة التي طلبت حذفها غير موجودة")
            else:
                raise e

@bot.message_handler(func=lambda message: message.reply_to_message and message.reply_to_message.from_user.id == bot.get_me().id)
def handle_mute_unmute_confirmation(message):
    user_id = message.reply_to_message.from_user.id
    chat_id = message.chat.id
    if message.text == 'تقييد':
        muted_users[user_id] = chat_id
        bot.reply_to(message.reply_to_message, "*- تم تقييد الشخص ✅ .*",parse_mode="Markdown")
    elif message.text == 'إلغاء تقييد':
        if user_id in muted_users and muted_users[user_id] == chat_id:
            del muted_users[user_id]
            bot.reply_to(message.reply_to_message, "*تم إلغاء التقييد*",parse_mode="Markdown")

@bot.message_handler(func=lambda message: message.text and message.reply_to_message and message.text.startswith("تقييد وقتي"))
def restrict_user(message):
    if message.from_user.id not in [admin.user.id for admin in bot.get_chat_administrators(message.chat.id)]:
        bot.reply_to(message, "᥀ انت مو مشرف ᥀")
        return
    user_id = message.reply_to_message.from_user.id
    bot.restrict_chat_member(message.chat.id, user_id, until_date=int(time.time())+600)
    bot.reply_to(message.reply_to_message, "᥀ تم تقييدك تقييد وقتي ᥀")
    time.sleep(600)
    bot.restrict_chat_member(message.chat.id, user_id, can_send_messages=True, can_send_media_messages=True, can_send_other_messages=True, can_add_web_page_previews=True)
    bot.reply_to(message.reply_to_message, "᥀ تم انتهاء مدة تقييدك هسه تكدر تحجي براحتك حبيبي ᥀")

locked_groups = []

@bot.message_handler(func=lambda message: message.text == "قفل الصور")
def lock_images(message):
    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if member.status in ['administrator', 'creator']:
        if chat_id not in locked_groups:
            locked_groups.append(chat_id)
        
        bot.reply_to(message, "*- تم قفل الصور بنجاح ✅*", parse_mode="markdown")
    else:
        bot.reply_to(message, "⌁︙انت مو ادمن ياعضو 💃🏻 !")

@bot.message_handler(func=lambda message: message.text == "فتح الصور")
def unlock_images(message):
    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if member.status in ['administrator', 'creator']:
        if chat_id in locked_groups:
            locked_groups.remove(chat_id)
        
        bot.reply_to(message, "*- تم فتح الصور بنجاح *✅", parse_mode="markdown")
    else:
        bot.reply_to(message, "⌁︙انت مو ادمن ياعضو 💃🏻 !")

@bot.message_handler(content_types=['photo'])
def handle_photos(message):
    user_id = message.from_user.id
    chat_id = message.chat.id
    member = bot.get_chat_member(chat_id, user_id)

    if chat_id in locked_groups and member.status not in ['administrator', 'creator']:
        bot.delete_message(chat_id, message.message_id)

@bot.message_handler(content_types=["photo"])
def delete_images(message):
    chat_id = message.chat.id
    
    if chat_id in locked_groups:
        
        bot.delete_message(chat_id, message.message_id)

@bot.message_handler(func=lambda message: message.text.startswith('انطق'))
def text_to_speech(message):

    text = message.text.split(' ', 1)[1]


    tts = gTTS(text=text, lang='ar')
    tts.save('audio.mp3')

    audio = open('audio.mp3', 'rb')
    bot.send_audio(chat_id=message.chat.id, audio=audio, performer= '- @MMMFi', title='- تم التحويل 🧜🏻 .')

    os.remove('audio.mp3')

@bot.message_handler(func=lambda message: message.text.lower() == 'نرد')
def roll_dice(message):
    dice = random.randint(1, 6)
    if dice == 6:
        bot.reply_to(message, """مبررررررررروووووك 🥹🎉 ! 
اخيرا فزت وحصلت على 6 👾 !
يامحظوظ يا محظوظ 😉 .""")

    else:
        bot.reply_to(message, """للاسف حظك مو حلو وما حصلت 6 😔 .
حظ اوفر اذا تريد تلعب اكتب ( `نرد` ) """,parse_mode="markdown")

@bot.message_handler(func=lambda message: message.text == "ايدي المجموعة")
def send_id(message):
    chat_id = message.chat.id
    bot.reply_to(message, f"🆔 *𝐈𝐃 𝐓𝐇𝐄 𝐆𝐑𝐎𝗨𝐏 :* `{chat_id}`",parse_mode="markdown")

@bot.message_handler(func=lambda message: message.text == "ايدي")
def send_id(message):
    bot.reply_to(message, f"*🆔 𝐘𝐎𝗨𝐑 𝐓𝐄𝐋𝐄𝐆𝐑𝐀𝐌 𝐈𝐃 𝐈𝐒 :*`{message.from_user.id}`",parse_mode="markdown")
    
@bot.message_handler(func=lambda message: message.text == "اسمي")
def send_name(message):
    chat_id = message.chat.id
    chat_info = bot.get_chat(chat_id)
    first_name = chat_info.first_name
    last_name = chat_info.last_name

    if first_name and last_name:
        bot.reply_to(message, f"𝐘𝐎𝗨𝐑 𝐍𝐀𝐌𝐄 𝐈𝐒 : {first_name} {last_name}")
    elif first_name:
        bot.reply_to(message, f"𝐘𝐎𝗨𝐑 𝐍𝐀𝐌𝐄 𝐈𝐒 : {first_name}")
    else:
        bot.reply_to(message, "*I couldn't find your name.*",parse_mode="markdown")

@bot.message_handler(func=lambda message: "سلة" in message.text)
def send_basketball(message):
    bot.send_message(message.chat.id, """تبي تلعب كرة السلة ! 
يلا انت اتحداك ونشوف مين يفوز ؟ 🐈""")
    bot.send_message(message.chat.id, '🏀')
    bot.send_message(message.chat.id, """ها يل ضعيف !
انا فزت عليك يلاا انقلع 😛😛 ؟
اذا تبي تلعب مع البوت 🧜🏻 
اضغط على اي كرة تعجبك بالاسفل بين الاقواس وبعدها ارسلها 🐥 .
(`🏀`) (`🏀`) (`🏀`) (`🏀`) (`🏀`) (`🏀`) """,parse_mode="markdown")

@bot.message_handler(func=lambda m: m.text == 'كرة' and not m.text.startswith('/'))
def send_ball(message):
    bot.reply_to(message, "⚽️")
    bot.send_message(message.chat.id,"""ياخي انت فاشل ؟ 
فزت عليك بـ سلة والحين افوز عليك بـ كرة ؟ 
متى تصير قوي 🤔 ؟
اذا تبي تلعب كرة مع البوت اكتب ( كرة ) 
لكن اذا تبي تلعب مع اخوياك (اصدقائك ) 
انسخ وحده من الكرات في الاسفل 👇🏻 .
(`⚽`) (`⚽`) (`⚽`) (`⚽`) (`⚽`) (`⚽`) (`⚽`)""",parse_mode="markdown")

@bot.message_handler(func=lambda message: message.text == "تفاعلي")
def handle_command(message):
    zkaa = random.randint(1, 100)
    response = f"""• نسبة تفاعلك : {zkaa}% 🌝
شد حيلك بعد حب 👍"""
    bot.send_message(message.chat.id, response)

@bot.message_handler(func=lambda message: message.text == "ذكائي")
def handle_command(message):
    zkaa = random.randint(1, 100)
    response = f"""نسبة ذكائك هي : {zkaa}% 
ماشاء الله 🫨 !"""
    bot.send_message(message.chat.id, response)

@bot.message_handler(func=lambda message: "رفع حلو" in message.text or "رفع حلوه" in message.text)
def send_random_answer(message):
    answers = ["ۿﯛ حلوُ مآ يحتآج 😍😂","مبروڪ أصبحت حݪو برو مآڪس 😭","صدڪني حاوݪت بس شڪݪة ميساعد 😂","تم رفعه حلوو بنجاح 🥹😘"]
    response = random.choice(answers)
    bot.send_message(message.chat.id, response)

@bot.message_handler(func=lambda message: message.text == "غبائي")
def handle_command(message):
    gbaa = random.randint(1, 100)
    response = f"""نسبة غبائك يالاثول هي : %{gbaa} 
طيح الله حظك 😂😛"""
    bot.send_message(message.chat.id, response)

@bot.message_handler(func=lambda message: "تحبني" in message.text or "تحبيني" in message.text)
def send_random_answer(message):
    answers = ["لللاااا عيعيع","يعع 🤢 !","شوي بسس 🤏🏻🤏🏻","اييهه احححبكك 😉😉","كلتبن ياخفيف !!! 🤮",'شعندِيّ ، غيࢪكَ🥵♥️♥️♥️','لا محد يحبك',]
    response = random.choice(answers)
    bot.send_message(message.chat.id, response)
 
           
@bot.message_handler(func=lambda message: "سورس" in message.text or "السورس" in message.text)
def handle_source_command(message):
    bot.reply_to(message, """- This bot is developed by Hamoudi AL-Amir 𓅂""")
    bot.send_message(message.chat.id,f"[Developer 🧑🏻‍💻 .](t.me/GoodMre)",parse_mode="markdown",disable_web_page_preview="true")
    bot.send_message(message.chat.id,f"[Channel ✅.](t.me/MMMFi)",parse_mode="markdown",disable_web_page_preview="true")
    
@bot.message_handler(func=lambda message: "كت" in message.text)
def respond(message):
    options = ["كلمتك اذا احد حشرك بالنقاش ؟","متى تصير نفسية ؟","وش الي يغلب عليك دائما .. قلبك ولا عقلك ؟","اكثر شيء تحبه بـ شكلك ؟","مع او ضد الصحبة تغني عن الحب ؟","ممكن تكره احد بدون سبب ؟","كم من عشرة تشوف صوتك حلو ؟","عشان تعيش مرتاح ؟","اكثر شيء تخاف منه ؟","من النوع اللي تعترف بسرعه ولا تجحد ؟","كيف تتعامل مع الشخص اللي يرد متأخر دايم ؟","متى تنام بالعادة ؟","شخص مستحيل تمسك ضحكتك معاه؟","دائما قوة الصداقة بـ ...؟","مودك الحين ؟","كم من عشرة تحب الهدوء ؟","لو حظك ينباع ، بكم بيكون ؟","شيء من الماضي للحين عندك ؟","شخص م تحب تناقشه ؟",'نهارك يصير أجمل بوجود ..؟','افضل هديه ممكن تناسبك؟','كلمة او عبارة مستحيل تنساها ؟','شاركنا صورة او فيديو من تصويرك؟📸','عمرك شاركت بمسابقة وفزت ؟','اطول مدة قضيتها بدون اكل ؟','احقر الناس هو من ...','اكتب ثلاث اشياء تحبها ؟','اكثر مشاكلك بسبب ...؟','لو احد قالك اكرهك وش بتقول له ؟','اذا احد سألك عن شيء م تعرفه تقول م اعرف ولا تتفلسف ؟','اذا كنت شخصاً غني هل توافق على الزواج من فتاة فقيرة..؟','من اصدق في الحب الولد ولا البنت؟.','تعتقد إنك انسان لك فايدة ؟']
    response = options[random.randint(0, len(options)-1)]
    bot.reply_to(message, response)
@bot.message_handler(func=lambda message: "بوت" in message.text)
def respond(message):
    options = ['عنديہ آسم وٰعٕيُونٓكً 🙂','أنتهہ ألبۅٛت ݪڪك 🍧🍇','• عنديہ آسم ترۿ 😃','بعد ڪلبي ﯛغرآضۿ ✨❤️‍🩹','ڪۅل ﺣﺑي ༻']
    response = options[random.randint(0, len(options)-1)]
    bot.reply_to(message, response)   
    
keyboard = types.InlineKeyboardMarkup()
A9 = types.InlineKeyboardButton(text="- Developer Channel ✓", url='https://t.me/MMMFi')
keyboard.add(A9)
sudo = 1

@bot.message_handler(func=lambda message: "شعر" in message.text)
def Get(message):
    try:
        song_voice = "https://t.me/Msna_ALamir/" + str(random.randint(1, 371))
        bot.send_voice(message.chat.id, song_voice, """* ⌯︙تم اختيار الشعر لك 🤍. *""", parse_mode="markdown", reply_markup=keyboard, reply_to_message_id=message.message_id)
    except Exception as er:
        print(er)
        pass

keyboard = types.InlineKeyboardMarkup()
A9 = types.InlineKeyboardButton(text="- Developer Channel ✓", url='https://t.me/MMMFi')
keyboard.add(A9)
sudo = 1

@bot.message_handler(func=lambda message: "سوره" in message.text)
def Get(message):
    try:
        song_voice = "https://t.me/Msna_ALamir/" + str(random.randint(372, 530))
        bot.send_voice(message.chat.id, song_voice, """* ⌯︙اخترت لك هذه السورة 🕋❤️. *""", parse_mode="markdown", reply_markup=keyboard, reply_to_message_id=message.message_id)
    except Exception as er:
        print(er)
        pass

@bot.message_handler(func=lambda message: message.text == 'الرابط' and message.reply_to_message is None)
def send_group_link(message):
    chat_id = message.chat.id
    group_link = bot.export_chat_invite_link(chat_id)
    bot.reply_to(message, f"*- 𝐆𝐑𝐎𝗨𝐏 𝐋𝐈𝐍𝐊 :-* {group_link}",parse_mode="Markdown")

@bot.message_handler(func=lambda message: message.text == "الاسرع")
def start_game(message):
    words = ['محمد','فيل','دجاجه','ثلاجه','مدرسه','عطارد','العراق','مصر','السعودية','حمودي','الامير','اسد','كرسي','كارتون','سجق','خوخ','برتقال','موز','عسل','ساعه','كهرباء','سياره','شمس','قمر','نجوم','ياسمين','الجزائر','طياره','سفينه','شاحنه','شركه','ضوء','ظلام','فواكه','سمسم','شاورما','باذنجان','طماطم']
    random_word = random.choice(words)
    chat_id = message.chat.id
    bot.send_message(chat_id, "- أسرع شخص يكتب : " + random_word)
    bot.register_next_step_handler(message, check_word, random_word)

def check_word(message, random_word):
    user_word = message.text 
    chat_id = message.chat.id 

    if user_word == random_word:
        bot.reply_to(message, "أحسنت ، انت الفائز 🥳")
    else:
        bot.reply_to(message, "للأسف لم تكن أنت الاسرع، حظ اوفر في المره القادمه 😇")

locked_stickers = False

@bot.message_handler(content_types=["sticker"])
def delete_stickers(message):
    if locked_stickers:
        user = bot.get_chat_member(message.chat.id, message.from_user.id)
        if user.status not in ['administrator', 'creator']:
            bot.delete_message(message.chat.id, message.message_id)

@bot.message_handler(func=lambda message: message.text == 'قفل الملصقات')
def lock_stickers(message):
    user = bot.get_chat_member(message.chat.id, message.from_user.id)
    if user.status in ['administrator', 'creator']:
        global locked_stickers
        locked_stickers = True
        bot.reply_to(message, '*- تم قفل الملصقات بنجاح ✅ .*',parse_mode="markdown")

@bot.message_handler(func=lambda message: message.text == 'فتح الملصقات')
def unlock_stickers(message):
    user = bot.get_chat_member(message.chat.id, message.from_user.id)
    if user.status in ['administrator', 'creator']:
        global locked_stickers
        locked_stickers = False
        bot.reply_to(message, '*- تم فتح الملصقات بنجاح ✅ .*',parse_mode="markdown")

@bot.message_handler(func=lambda message: message.text in ['قفل الملصقات', 'فتح الملصقات'])
def ignore_commands(message):
    user = bot.get_chat_member(message.chat.id, message.from_user.id)
    if user.status not in ['administrator', 'creator']:
        bot.delete_message(message.chat.id, message.message_id)


responses = {}

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    if message.text == "اضف رد":
        user_role = get_user_role(message.chat.id, message.from_user.id)
        
        if user_role in ["creator", "administrator"]:
            bot.reply_to(message, '*- ارسل الان الكلمة التي تريد عمل رد لها ✨...*',parse_mode="markdown")
            bot.register_next_step_handler(message, add_response_key)
        else:
            bot.reply_to(message, '*- ليس لديك صلاحية لاستخدام الأمر هنا❗. *',parse_mode="markdown")
    elif message.text == "حذف رد":
        user_role = get_user_role(message.chat.id, message.from_user.id)
        
        if user_role in ["creator", "administrator"]:
            bot.reply_to(message, '*- ارسل الكلمه التي تريد حذفها من الردود ... *',parse_mode="markdown")
            bot.register_next_step_handler(message, delete_response)
        else:
            bot.reply_to(message, '*- ليس لديك صلاحية لاستخدام الأمر هنا❗. *',parse_mode="markdown")
    elif message.text == "قائمة الردود":
        user_role = get_user_role(message.chat.id, message.from_user.id)
        if user_role in ["creator", "administrator"]:
            list_responses(message)
        else:
            bot.reply_to(message, '*- ليس لديك صلاحية لاستخدام الأمر هنا❗. *',parse_mode="markdown")
    elif message.text == "حذف الردود":
        user_role = get_user_role(message.chat.id, message.from_user.id)
        if user_role in ["creator", "administrator"]:
            confirm_deletion(message)
        else:
            bot.reply_to(message, '*- ليس لديك صلاحية لاستخدام الأمر هنا❗. *',parse_mode="markdown")
    else:
        respond(message)

def confirm_deletion(message):
    user_id = message.from_user.id  # أضفت هذا السطر للحصول على user_id
    user_name = message.from_user.first_name
    markup = types.InlineKeyboardMarkup()
    yes_button = types.InlineKeyboardButton("نعم ✅", callback_data="delete_yes")
    no_button = types.InlineKeyboardButton("لا ❌", callback_data="delete_no")
    markup.row(yes_button, no_button)
    
    bot.reply_to(message, f'*- عزيزي *[{user_name}](tg://user?id={user_id})* هل أنت متأكد من أنك تريد حذف جميع الردود؟ *\n', parse_mode="markdown", reply_markup=markup)

@bot.callback_query_handler(func=lambda call: True)
def callback_handler(call):
    if call.data == "delete_yes":
        user_id = call.from_user.id
        user_role = get_user_role(call.message.chat.id, user_id)
        if user_role in ["creator", "administrator"]:
            delete_all_responses(call.message)
            bot.answer_callback_query(call.id, "تم حذف جميع الردود بنجاح 📛. ")
            
        else:
            bot.answer_callback_query(call.id, "ليس لديك صلاحية لهذا الإجراء.")
    elif call.data == "delete_no":
        bot.answer_callback_query(call.id, "- تم تجاهل الأمر ™. ")

def delete_all_responses(message):
    global responses
    responses = {}
    
    developer_channel_button = types.InlineKeyboardButton("Developer Channel ✓", url="https://t.me/MMMFi")
    markup = types.InlineKeyboardMarkup()
    markup.add(developer_channel_button)

    bot.reply_to(message, "*- تم حذف جميع الردود بنجاح 📛. *", parse_mode="markdown", reply_markup=markup)

def add_response_key(message):
    keyword = message.text
    bot.reply_to(message, '*- ارسل الان محتوى الرد 🔱.*',parse_mode="markdown")
    bot.register_next_step_handler(message, add_response_content, keyword)

def add_response_content(message, keyword):
    content_type = message.content_type
    content = None
    description = None
    
    if content_type == 'text':
        content = message.text
    elif content_type == 'photo':
        content = message.photo[-1].file_id
        description = message.caption
    elif content_type == 'video':
        content = message.video.file_id
        description = message.caption
    elif content_type == 'sticker':
        content = message.sticker.file_id

    if content:
        responses[keyword] = {"content_type": content_type, "content": content, "description": description}
        bot.reply_to(message, "*- تم إضافة الرد بنجاح ✅. *",parse_mode="markdown")
        
    else:
        bot.reply_to(message, 'حدث خطأ أثناء إضافة الرد. يرجى المحاوله مره اخرى')
               
def delete_response(message):
    keyword = message.text
    if keyword in responses:
        del responses[keyword]
        bot.reply_to(message, "*- تم حذف الرد بنجاح ✅. *",parse_mode="markdown")
    else:
        bot.reply_to(message, '*- لا يوجد رد لهذه الكلمة في قائمة الردود❗. *',parse_mode="markdown")

def list_responses(message):
    if responses:
        response_list = "قائمة الردود:\n"
        for keyword, response in responses.items():
            response_list += f"الكلمة المفتاحية: {keyword}\n"
            response_list += f"نوع الرد: {response['content_type']}\n"
            response_list += f"الوصف: {response['description']}\n\n"
        
        bot.reply_to(message, response_list)
    else:
        bot.reply_to(message, "*- لا توجد ردود مضافة حتى الآن ❌. *",parse_mode="markdown")

def respond(message):
    keyword = message.text
    response = None
    
    for key, value in responses.items():
        if key in keyword:
            response = value
            break
    
    if response:
        content_type = response["content_type"]
        content = response["content"]
        description = response["description"]
        
        if content_type == 'text':
            bot.reply_to(message, content)
        elif content_type == 'photo':
            bot.send_photo(message.chat.id, content, caption=description)
        elif content_type == 'video':
            bot.send_video(message.chat.id, content, caption=description)
        elif content_type == 'sticker':
            bot.send_sticker(message.chat.id, content)

def get_user_role(chat_id, user_id):
    try:
        chat_member = bot.get_chat_member(chat_id, user_id)
        return chat_member.status
    except Exception as e:
        print(e)
        return None                                  
                                 
warnings = {}
restricted_users = []

@bot.message_handler(func=lambda message: message.chat.type == 'group' or message.chat.type == 'supergroup')
def handle_group_message(message):
    if message.reply_to_message and is_admin(message.from_user.id, message.chat.id):
        user_id = message.reply_to_message.from_user.id
        if "تحذير" in message.text:
            if user_id in restricted_users:
                bot.reply_to(message, "*- تم تحذير هذا الشخص 3 مرات سابقاً وتم تقييده، لـ تقييد الشخص مرة أخرى ارسل الأمر* تقييد *بالرد علية 📛.*", parse_mode="Markdown")
            else:
                if user_id not in warnings:
                    warnings[user_id] = 1
                else:
                    warnings[user_id] += 1
                if warnings[user_id] == 3:
                    bot.restrict_chat_member(message.chat.id, user_id, until_date=0)
                    restricted_users.append(user_id)
                    bot.reply_to(message, f"*- تم تقييد المستخدم* [{message.reply_to_message.from_user.first_name}](tg://user?id={user_id}) *بنجاح بسبب تحذيره ثلاث مرات!* ✅", parse_mode="Markdown")
                else:
                    warning_message = "تحذير!"
                    if warnings[user_id] == 2:
                        warning_message += f" لديك *تحذيرين* من اصل *ثلاث، كن حذراً ⚠️.*\n\n[{message.reply_to_message.from_user.first_name}](tg://user?id={user_id})"
                    else:
                        warning_message += f" لديك تحذير *واحد* من اصل *ثلاث كن حذراً ⚠️.*\n\n[{message.reply_to_message.from_user.first_name}](tg://user?id={user_id})"
                    bot.reply_to(message, warning_message, parse_mode="Markdown")

def is_admin(user_id, chat_id):
    admins = bot.get_chat_administrators(chat_id)
    admin_ids = [admin.user.id for admin in admins]
    return user_id in admin_ids

@bot.message_handler(func=lambda message: message.chat.type ==  'private',content_types=['text'])
def forward(message): 
 bot.forward_message(sudo,message.chat.id,message.message_id)
 
#This bot is developed by Hamoudi AL-Amir 𓅂
#Developer Channel | @MMMFi ✓.       
print("- @MMMFi")
bot.polling()